#https://docs.dapr.io/developing-applications/local-development/multi-app-dapr-run/multi-app-template/
version: 1
common:
  resourcesPath: ./components
  # env:
  #   DEBUG: true
apps:
  - appID: gateway
    appDirPath: ./
    appPort: 3000
    daprHTTPPort: 8000
    command: ["go","run", "gateway/main.go", "devMode"]
    env:
      GATEWAY_PORT: 3000
      GATEWAY_TOPIC_BALANCE: topic.balance
  - appID: balance
    appDirPath: ./
    appPort: 3002
    daprHTTPPort: 8002
    command: ["go","run", "balanceservice/main.go"]
    env:
      BALANCE_PORT: 3002
      BALANCE_DB_DRIVER: sqlite3
      BALANCE_DB_DATASOURCE: file:localdev/sqlitedata/main.db
      BALANCE_SUBSCRIBER_PORT: 3012
      BALANCE_TOPIC_BALANCE: topic.balance
      BALANCE_TOPIC_CREDIT_TRANSACTION: topic.credit_transaction
      BALANCE_TOPIC_DEBIT_TRANSACTION: topic.debit_transaction
  # - appID: credit-tnx
  #   appDirPath: .
  #   appPort: 3001
  #   daprHTTPPort: 8001
  #   command: ["go","run", "transactionservice/main.go", "creditMode"]
  #   env:
  #     CREDITTNX_TOPIC_BALANCE: topic.balance
  #     CREDITTNX_TOPIC_CREDIT_TRANSACTION: topic.credit_transaction
  # - appID: debit-tnx
  #   appDirPath: .
  #   appPort: 3001
  #   daprHTTPPort: 8001
  #   command: ["go","run", "transactionservice/main.go", "debitMode"]
  #   env:
  #     DEBITTNX_TOPIC_BALANCE: topic.balance
  #     DEBITTNX_TOPIC_DEBIT_TRANSACTION: topic.debit_transaction